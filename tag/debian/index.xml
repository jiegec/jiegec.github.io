<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
 <title>Tag - debian</title>
 <link href="https://jiegec.me/tag/debian/index.xml" rel="self"/>
 <link href="https://jiegec.me/tag/debian.html"/>
 <updated>2018-12-14T16:12:58+08:00</updated>
 <id>https://jiegec.me/tag/debian.html</id>
 <author>
   <name>Jiege Chen</name>
 </author>
 
 <entry>
   <title>用 MuSSH 快速对多台机器进行软件包升级</title>
   <link href="https://jiegec.me/devop/2018/07/15/use-mussh-to-upgrade-multiple-machines/"/>
   <updated>2018-07-15T01:10:00+08:00</updated>
   <id>https://jiegec.me/devop/2018/07/15/use-mussh-to-upgrade-multiple-machines</id>
   <content type="html">&lt;p&gt;Debian Stretch 9.5 刚刚更新，自己手上有不少 stretch 的机器，于是顺手把他们都升级了。不过，这个过程比较繁琐，于是我采用了 MuSSH 的方法，让这个效率可以提高，即自动同时 SSH 到多台机器上进行更新。&lt;/p&gt;

&lt;p&gt;首先编写 hostlist 文件，一行一个地址，分别对应每台机器。&lt;/p&gt;

&lt;p&gt;然后采用 MuSSH 对每台机器执行同样的命令&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mussh &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; hostlist &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'apt update &amp;amp;&amp;amp; apt upgrade -y'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;此时要求，ssh 上去以后有相应的权限。这个有许多方法，不再赘述。然后就可以看到一台台机器升级，打上安全补丁，爽啊。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>配置 fcitx-fbterm 实现在终端下显示和输入中文</title>
   <link href="https://jiegec.me/misc/2018/07/12/using-fcitx-fbterm/"/>
   <updated>2018-07-12T23:06:00+08:00</updated>
   <id>https://jiegec.me/misc/2018/07/12/using-fcitx-fbterm</id>
   <content type="html">&lt;p&gt;参考网站：&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.linuxidc.com/Linux/2015-01/111976.htm&quot;&gt;Ubuntu使用fbterm无法打开fb设备的解决及fcitx-fbterm安装&lt;/a&gt;
&lt;a href=&quot;https://wiki.archlinux.org/index.php/fcitx&quot;&gt;Fcitx - ArchWiki&lt;/a&gt;
&lt;a href=&quot;https://blog.csdn.net/guozhiyingguo/article/details/52852394&quot;&gt;完美中文tty, fbterm+yong(小小输入法)&lt;/a&gt;
&lt;a href=&quot;http://www.voidcn.com/article/p-wrcgydjy-er.html&quot;&gt;让linux console支持中文显示和fcitx输入法&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;考虑到 lemote yeeloong 机器的 cpu 运算性能，跑一个图形界面会非常卡，于是选择直接用 framebuffer 。但是，显示中文又成了问题。于是，采用了 fbterm 和 fcitx 配合，加上 gdm 的方法，完成了终端下的中文输入。&lt;/p&gt;

&lt;p&gt;首先，安装相关的包：&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt install gpm fcitx-fronend-fbterm dbus-x11 fbterm fonts-wqy-zenhei
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;接着，基于以上参考网站第一个，编写 zhterm 文件：&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;zhterm
&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;dbus-launch &lt;span class=&quot;nt&quot;&gt;--auto-syntax&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
fcitx &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;/dev/null 2&amp;gt;&amp;amp;1
fbterm &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; fcitx-fbterm
&lt;span class=&quot;nb&quot;&gt;kill&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$DBUS_SESSION_BUS_PID&lt;/span&gt;
fcitx-remote &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;chmod +x zhterm
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;zhterm
&lt;span class=&quot;c&quot;&gt;# Use C-SPC to switch input source&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;另：找到一个&lt;a href=&quot;https://unix.stackexchange.com/a/7682/144358&quot;&gt;映射 Caps Lock 到 Escape 的方案&lt;/a&gt;：&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo bash -c &quot;dumpkeys | sed 's/CtrlL_Lock/Escape/' | loadkeys&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</content>
 </entry>
 
 <entry>
   <title>在 Lemote Yeeloong 上安装 Debian jessie</title>
   <link href="https://jiegec.me/devops/2018/07/11/installing-debian-in-lemote-yeeloong/"/>
   <updated>2018-07-11T23:12:00+08:00</updated>
   <id>https://jiegec.me/devops/2018/07/11/installing-debian-in-lemote-yeeloong</id>
   <content type="html">&lt;p&gt;参考网站：&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://wiki.gnewsense.org/Projects/GNewSenseToMIPS&quot;&gt;gNewSense To MIPS&lt;/a&gt;
&lt;a href=&quot;https://rick.cogley.info/post/run-a-tftp-server-on-mac-osx/&quot;&gt;Run a TFTP server on macOS&lt;/a&gt;
&lt;a href=&quot;https://wiki.debian.org/DebianYeeloong&quot;&gt;Debian on Yeeloong&lt;/a&gt;
&lt;a href=&quot;https://wiki.debian.org/MIPSPort&quot;&gt;Debian MIPS port wiki&lt;/a&gt;
&lt;a href=&quot;https://www.debian.org/ports/mips/&quot;&gt;Debian MIPS port&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;首先，进入设备的 PMON：&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Press Del to enter PMON
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;然后，下载 Debian Jessie 的 netboot 文件：&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ wget https://mirrors.tuna.tsinghua.edu.cn/debian/dists/jessie/main/installer-mipsel/current/images/loongson-2f/netboot/vmlinux-3.16.0-6-loongson-2f
$ wget https://mirrors.tuna.tsinghua.edu.cn/debian/dists/jessie/main/installer-mipsel/current/images/loongson-2f/netboot/initrd.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;以 macOS 为例，起一个 tftp 服务器以供远程下载：&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# ln -s these files to /private/tftpboot:&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# initrd.gz&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# vmlinux-4.16.0-6-loongson-2f&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;launchctl load &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; /System/Library/LaunchDaemons/tftp.plist
&lt;span class=&quot;c&quot;&gt;# set addr manually to 192.168.2.1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;回到 PMON ，配置远程启动：&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; ifaddr rtl0 192.168.2.2
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; load tftp://192.168.2.1/vmlinux-3.16.0-6-loongson-2f
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; initrd tftp://192.168.2.1/initrd.gz
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; g
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;之后就是熟悉的 Debian Installer 界面。起来之后，就可以顺手把 tftp 服务器关了：&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;launchctl unload &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; /System/Library/LaunchDaemons/tftp.plist
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实测滚到 stretch 会挂。因为 stretch 虽然也有 mipsel 架构，但是它的 revision 与 Loongson-2f 不大一样，会到处出现 SIGILL 的问题，不可用。靠 jessie 和 jessie-backports 已经有不少的软件可以使用了。&lt;/p&gt;
</content>
 </entry>
 
</feed>
