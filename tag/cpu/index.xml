<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
 <title>Tag - CPU</title>
 <link href="https://jiegec.github.io/tag/cpu/index.xml" rel="self"/>
 <link href="https://jiegec.github.io/tag/CPU.html"/>
 <updated>2017-10-30T21:15:32+08:00</updated>
 <id>https://jiegec.github.io/tag/CPU.html</id>
 <author>
   <name>Jiege Chen</name>
 </author>
 
 <entry>
   <title>用CPUID获取评测机器的CPU</title>
   <link href="https://jiegec.github.io/oi/2017/10/30/use-cpuid-to-get-machine-cpu/"/>
   <updated>2017-10-30T21:07:23+08:00</updated>
   <id>https://jiegec.github.io/oi/2017/10/30/use-cpuid-to-get-machine-cpu</id>
   <content type="html">&lt;p&gt;受&lt;a href=&quot;https://zhuanlan.zhihu.com/p/28322626&quot;&gt;用 CPUID 检测各大 OJ 测评机所用的 CPU（以及日常黑 BZOJ）&lt;/a&gt;的启发，我决定去测试一下徐老师自己写的OJ（名为Tyche）所跑的机器是什么CPU。于是我改造一下代码，用以下代码测评：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#include &amp;lt;stdint.h&amp;gt;
#include &amp;lt;iostream&amp;gt;
#include &amp;lt;time.h&amp;gt;
#include &amp;lt;cpuid.h&amp;gt;
#include &amp;lt;sys/time.h&amp;gt;
static void cpuid(uint32_t func, uint32_t sub, uint32_t data[4]) {
    __cpuid_count(func, sub, data[0], data[1], data[2], data[3]);
}
int main() {
    uint32_t data[4];
    char str[48];
    for(int i = 0; i &amp;lt; 3; ++i) {
        cpuid(0x80000002 + i, 0, data);
        for(int j = 0; j &amp;lt; 4; ++j)
            reinterpret_cast&amp;lt;uint32_t*&amp;gt;(str)[i * 4 + j] = data[j];
    }

    struct timeval stop, start;
    gettimeofday(&amp;amp;start, NULL);
    while(1) {
        gettimeofday(&amp;amp;stop, NULL);
        if(stop.tv_usec - start.tv_usec &amp;gt; (str[##EDITME##] - 32) * 10000)
            break;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;经过测试，&lt;code class=&quot;highlighter-rouge&quot;&gt;usleep()&lt;/code&gt;和&lt;code class=&quot;highlighter-rouge&quot;&gt;clock()&lt;/code&gt;都被封杀，但是&lt;code class=&quot;highlighter-rouge&quot;&gt;gettimeofday()&lt;/code&gt;存活了下来。然后我就不断地&lt;code class=&quot;highlighter-rouge&quot;&gt;C-a&lt;/code&gt;上面的&lt;code class=&quot;highlighter-rouge&quot;&gt;###EDITME###&lt;/code&gt;，根据评测出来的时间推算出字符串，然后得到以下结果：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;0 ~ 7 : PADDING
8 73 I
9 110 n
10 116 t
11 101 e
12 108 l
13 40 (
14 82 R
15 41 )
16 32 SPC
17 67 C
18 111 o
19 114 r
20 101 e
21 40 (
22 84 T
23 77 M
24 41 )
25 32 SPC
26 105 i
27 51 3
28 45 -
29 50 2
30 49 1
31 50 2
32 48 0
33 32 SPC
34 67 C
35 80 P
36 85 U
37 32 SPC
38 64 @
39 32 SPC
40 51 3
41 46 .
42 51 3
43 48 0
44 71 G
45 72 H
46 122 z
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;连起来就是&lt;a href=&quot;https://ark.intel.com/zh-cn/products/53426/Intel-Core-i3-2120-Processor-3M-Cache-3_30-GHz&quot;&gt;这个CPU&lt;/a&gt;：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Intel(R) Core(TM) i3-2120 CPU @ 3.30GHz
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;相比之下，还是比BZOJ好哈哈哈（又黑BZOJ）。后来有大神在群里建议，可以用字符串比较的方式，对了就让题目AC，不对就WA。这个方法更加适合手里已经知道了一些常见CPUID的返回字符串，这里就是这样。&lt;/p&gt;
</content>
 </entry>
 
</feed>
