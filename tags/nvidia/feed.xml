<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>nvidia on 杰哥的{运维,编程,调板子}小笔记</title>
    <link>https://jia.je/tags/nvidia/</link>
    <description>Recent content in nvidia on 杰哥的{运维,编程,调板子}小笔记</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Wed, 23 Nov 2022 19:24:00 +0800</lastBuildDate><atom:link href="https://jia.je/tags/nvidia/feed.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>升级 Mellanox 网卡固件</title>
      <link>https://jia.je/hardware/2022/11/23/upgrade-mlnx-firmware/</link>
      <pubDate>Wed, 23 Nov 2022 19:24:00 +0800</pubDate>
      
      <guid>https://jia.je/hardware/2022/11/23/upgrade-mlnx-firmware/</guid>
      <description>背景 最近发现有一台机器，插上 ConnectX-4 IB 网卡后，内核模块可以识别到设备，但是无法使用，现象是 ibstat 等命令都看不到设备。降级 OFED 从 5.8 到 5.4 以后问题消失，所以认为可能是新的 OFED 与比较旧的固件版本有兼容性问题，所以尝试升级网卡固件。升级以后，问题就消失了。
安装 MFT 首先，在 https://network.nvidia.com/products/adapter-software/firmware-tools/ 下载 MFT，按照指示解压，安装后，启动 mst 服务，就可以使用 mlxfwmanager 得到网卡的型号以及固件版本：
Device Type: ConnectX4 Description: Mellanox ConnectX-4 Single Port EDR PCIE Adapter LP PSID: DEL2180110032 Versions: Current FW 12.20.1820 升级固件 从 PSID 可以看到，这是 DELL OEM 版本的网卡，可以在 https://network.nvidia.com/support/firmware/dell/ 处寻找最新固件，注意需要保证 PSID 一致，可以找到这个 PSID 的 DELL 固件地址：https://www.mellanox.com/downloads/firmware/fw-ConnectX4-rel-12_28_4512-06W1HY_0JJN39_Ax-FlexBoot-3.6.203.bin.zip。
下载以后，解压，然后就可以升级固件：
mlxfwmanager -u -i fw-ConnectX4-rel-12_28_4512-06W1HY_0JJN39_Ax-FlexBoot-3.6.203.bin 升级以后重启就工作了。
考虑到类似的情况之后还可能发生，顺便还升级了其他几台机器的网卡，下面是一个例子：
Device Type: ConnectX4 Description: ConnectX-4 VPI adapter card; FDR IB (56Gb/s) and 40GbE; dual-port QSFP28; PCIe3.</description>
    </item>
    
    <item>
      <title>NVIDIA 驱动和 CUDA 安装速查</title>
      <link>https://jia.je/software/2022/07/06/install-nvidia-cuda/</link>
      <pubDate>Wed, 06 Jul 2022 11:42:00 +0800</pubDate>
      
      <guid>https://jia.je/software/2022/07/06/install-nvidia-cuda/</guid>
      <description>背景 最近在 Ubuntu 上配置 NVIDIA 驱动和 CUDA 环境的次数比较多，在此总结一下整个流程，作为教程供大家学习。
配置 NVIDIA APT 源 Ubuntu 源有自带的 NVIDIA 驱动版本，但这里我们要使用 NVIDIA 的 APT 源。首先，我们要访问 https://developer.nvidia.com/cuda-downloads?target_os=Linux&amp;amp;target_arch=x86_64&amp;amp;Distribution=Ubuntu&amp;amp;target_version=20.04&amp;amp;target_type=deb_network，在网页中选择我们的系统，例如：
Operating System: Linux Architecture: x86_64 Distribution: Ubuntu Version: 20.04 Installer Type: deb (network) 此时，下面就会显示一些命令，复制下来执行：
wget https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2004/x86_64/cuda-keyring_1.0-1_all.deb sudo dpkg -i cuda-keyring_1.0-1_all.deb sudo apt-get update 最后一步的 sudo apt-get -y install cuda 可以不着急安装，我们在后面再来讨论 CUDA 版本的问题。
NVIDIA 驱动 配置好源以后，接下来，我们就要安装 NVIDIA 驱动了。首先，我们要选取一个 NVIDIA 版本，选择的标准如下：
驱动版本需要支持所使用的显卡 驱动版本需要支持所使用的 CUDA 版本 这些信息在网络上都可以查到，也可以参考 NVIDIA 驱动和 CUDA 版本信息速查。
假如我们已经选择了要安装 470.</description>
    </item>
    
    <item>
      <title>XRDP 和 NVIDIA 显卡兼容性问题</title>
      <link>https://jia.je/software/2021/12/29/xrdp-nvidia/</link>
      <pubDate>Wed, 29 Dec 2021 15:31:00 +0800</pubDate>
      
      <guid>https://jia.je/software/2021/12/29/xrdp-nvidia/</guid>
      <description>背景 最近在尝试配置 XRDP，发现它在有 NVIDIA 的机器上启动远程桌面后会黑屏，查看错误信息可以看到：
xf86OpenConsole: Cannot open virtual console 1 (Permission denied) 解决方法 XRDP 作者在 issue #2010 中提到了解决方法：
修改 /etc/xrdp/sesman.ini，在 [Xorg] 部分里加上下面的配置：
param=-configdir param=/ 实际上就是不让 Xorg 加载 nvidia xorg 驱动，这样就绕过了问题。</description>
    </item>
    
    <item>
      <title>NVIDIA 驱动和 CUDA 版本信息速查</title>
      <link>https://jia.je/software/2021/12/26/nvidia-cuda/</link>
      <pubDate>Sun, 26 Dec 2021 16:03:00 +0800</pubDate>
      
      <guid>https://jia.je/software/2021/12/26/nvidia-cuda/</guid>
      <description>背景 之前和 NVIDIA 驱动和 CUDA 搏斗比较多，因此记录一下一些常用信息，方便查询。
常用地址 CUDA Toolkit Downloads NVIDIA Driver Installation Quickstart Guide NVIDIA Driver Downloads NVIDIA Docker Installation Guide CUDA 版本与 NVIDIA 驱动兼容性 可以通过 apt show cuda-runtime-x-x 找到：
cuda 11.7 &amp;gt;= 515 cuda 11.6 &amp;gt;= 510 cuda 11.5 &amp;gt;= 495 cuda 11.4 &amp;gt;= 470 cuda 11.3 &amp;gt;= 465 cuda 11.2 &amp;gt;= 460 cuda 11.1 &amp;gt;= 455 cuda 11.0 &amp;gt;= 450 cuda 10.2 &amp;gt;= 440 cuda 10.1 &amp;gt;= 418 cuda 10.</description>
    </item>
    
  </channel>
</rss>
