<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>杰哥的{运维,编程}小笔记</title>
    <description>This is the personal blog of Jiajie Chen, a NANO(uNix hAcker aNd lOver).
</description>
    <link>https://jiegec.me/</link>
    <atom:link href="https://jiegec.me/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Sat, 22 Dec 2018 00:31:19 +0800</pubDate>
    <lastBuildDate>Sat, 22 Dec 2018 00:31:19 +0800</lastBuildDate>
    <generator>Jekyll v3.7.4</generator>
    
      <item>
        <title>每周分享第 3 期</title>
        <description>&lt;p&gt;因为 DDL ，咕了一小会。&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;被 Windows 保存为 Unicode 文件坑了 BOM 配上 UTF-16 太难受了&lt;/li&gt;
  &lt;li&gt;Github 最近添加了很多 Issue 方面的更新，如 Pin 和 Delete&lt;/li&gt;
  &lt;li&gt;Grafana 真的很好看很好用 推荐大家自己配一套监控系统&lt;/li&gt;
  &lt;li&gt;Microsoft Remote Desktop Beta 新增了 AVC Codec 有意思 不知道啥时候上 HEVC&lt;/li&gt;
  &lt;li&gt;发现一个很好玩的用 Rust 写的网页游戏 https://sandspiel.club/#&lt;/li&gt;
  &lt;li&gt;Python Pattern Matching https://github.com/santinic/pampy&lt;/li&gt;
  &lt;li&gt;大新闻：MIPS Open Source 了 https://www.eetimes.com/document.asp?doc_id=1334087&lt;/li&gt;
  &lt;li&gt;GRPC 调试的 GUI https://github.com/uw-labs/bloomrpc 对标 Postman&lt;/li&gt;
  &lt;li&gt;酷炫的屏幕保护 for Mac https://github.com/JohnCoates/Aerial&lt;/li&gt;
  &lt;li&gt;WPF 开源了 不知道啥时候支持 *nix https://github.com/dotnet/wpf&lt;/li&gt;
  &lt;li&gt;分享欢乐 https://github.com/dotnet/wpf&lt;/li&gt;
  &lt;li&gt;分享欢乐x2 https://lore.kernel.org/patchwork/patch/628142/&lt;/li&gt;
  &lt;li&gt;谷歌近日到处上线了 Material Design 2.0 感觉风格不大习惯&lt;/li&gt;
  &lt;li&gt;veonim/veonim 的 Tag 里有 #meme-driven-development 太好笑了&lt;/li&gt;
  &lt;li&gt;巨硬开源了自己的 UEFI 和 TianoCore EDK 竞争 https://blogs.windows.com/buildingapps/2018/12/19/%e2%80%afintroducing-project-mu/&lt;/li&gt;
  &lt;li&gt;Github 的 GDPR 完全体上线 https://blog.github.com/2018-12-19-download-your-data/&lt;/li&gt;
  &lt;li&gt;ZFSonLinux 要统治 ZFS 世界的节奏 https://lists.freebsd.org/pipermail/freebsd-current/2018-December/072422.html&lt;/li&gt;
  &lt;li&gt;VBScript 真的是太多漏洞了 满目疮痍 https://googleprojectzero.blogspot.com/2018/12/on-vbscript.html&lt;/li&gt;
  &lt;li&gt;原来取名真的这么草率的吗 我也想买一个了 https://www.solidot.org/story?sid=59028&lt;/li&gt;
&lt;/ol&gt;
</description>
        <pubDate>Sat, 22 Dec 2018 00:19:00 +0800</pubDate>
        <link>https://jiegec.me/misc/2018/12/22/weekly-sharing-3/</link>
        <guid isPermaLink="true">https://jiegec.me/misc/2018/12/22/weekly-sharing-3/</guid>
        
        <category>weeklysharing</category>
        
        
        <category>misc</category>
        
      </item>
    
      <item>
        <title>每周分享第 2 期</title>
        <description>&lt;p&gt;继续，继续。&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;用代码呈现硬件实现对性能的影响，值得一读 &lt;a href=&quot;https://github.com/Kobzol/hardware-effects&quot;&gt;链接&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;发现了一个蛮少见的编码标准 AVS2 ，才发现是中国主导的 &lt;a href=&quot;https://github.com/pkuvcl/xavs2&quot;&gt;编码器&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;linux.org 的 DNS 被篡改了，认准 kernel.org 即可&lt;/li&gt;
  &lt;li&gt;一个处理器的电路的在线可视化 &lt;a href=&quot;https://www.theregister.co.uk/2015/11/28/arm1_visualized/&quot;&gt;ARM1 visualized&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;WASM 家庭现已加入 Nginx &lt;a href=&quot;https://www.wasmjit.org/blog/nginx-on-wasmjit.html&quot;&gt;链接&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;用 .bat 编写汇编语言 &lt;a href=&quot;https://github.com/mniip/BOOTSTRA/tree/master/BATAS#batas&quot;&gt;mnnip/BOOTSTRA&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Gitlab 挺香的，兹瓷 git-lfs ，还可以自己给自己的项目配一个 ci runner&lt;/li&gt;
  &lt;li&gt;LaTeX 的 subfigure 之间如果有空行，就真的换了一行，所以同一行的 subfigure 不要换行&lt;/li&gt;
  &lt;li&gt;Rocket 4.0 出了，看起来不错，要是作者更新一下 CS140e 就好了 &lt;a href=&quot;https://github.com/SergioBenitez/Rocket/blob/v0.4.0/CHANGELOG.md#version-040-dec-06-2018&quot;&gt;链接&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;装机必备，查询 Arch Wiki &lt;a href=&quot;https://www.npmjs.com/package/arch-wiki-man&quot;&gt;arch-wiki-man&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;LaTeX 里 \newcommand 时，如果文件名有多个 ‘.’ ，要特殊处理 &lt;a href=&quot;https://tex.stackexchange.com/questions/10574/includegraphics-dots-in-filename&quot;&gt;链接&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;RunAsDate for *nix &lt;a href=&quot;https://github.com/wolfcw/libfaketime&quot;&gt;wolfcw/libfaketime&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;用数据库做数据分析似乎是个不错的选择&lt;/li&gt;
  &lt;li&gt;Canvas 配合 globalCompositionOperation 能做到不少东西&lt;/li&gt;
  &lt;li&gt;才知道有 Time Machine over SMB 这种操作 &lt;a href=&quot;https://support.apple.com/zh-cn/guide/mac-help/mchl31533145/mac&quot;&gt;链接&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;mDNS repeater 把两个子网的 mDNS 打通 &lt;a href=&quot;https://github.com/kennylevinsen/mdns-repeater&quot;&gt;kennylevinsen/mdns-repeater&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Office 2019 for Mac 的 December 2018 release 添加了 Dark Mode ，并且也支持了 Continuity Camera ，直接从手机拍照导入&lt;/li&gt;
  &lt;li&gt;Gitlab serverless 发布，期待 &lt;a href=&quot;https://about.gitlab.com/2018/12/11/introducing-gitlab-serverless/&quot;&gt;链接&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;用 NAS 作为 Time Machine 备份盘的方法 &lt;a href=&quot;https://kirb.me/2018/03/24/using-samba-as-a-time-machine-network-server.html&quot;&gt;链接&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;研究了一下，Time Machine over SMB 在 macOS 里的表现形式是 apfs 里写了一个 sparse bundle ，bundle 里面是 HFS+ 。&lt;/li&gt;
&lt;/ol&gt;
</description>
        <pubDate>Fri, 14 Dec 2018 15:55:00 +0800</pubDate>
        <link>https://jiegec.me/misc/2018/12/14/weekly-sharing-2/</link>
        <guid isPermaLink="true">https://jiegec.me/misc/2018/12/14/weekly-sharing-2/</guid>
        
        <category>weeklysharing</category>
        
        
        <category>misc</category>
        
      </item>
    
      <item>
        <title>配置 homebridge-mi-aqara 并添加为 telegraf 的数据源</title>
        <description>&lt;p&gt;最近有了设备，想把设备拿到的数据都导一份存到 influxdb 里，但是目前找到的只有 &lt;a href=&quot;https://github.com/YinHangCode/homebridge-mi-aqara&quot;&gt;homebridge-mi-aqara&lt;/a&gt; 可以访问并拿到数据，然后它又提供了 mqtt 的数据获取方案，于是自己写了个脚本去读取这些数据。&lt;/p&gt;

&lt;p&gt;首先当然是配置一下 homebridge-mi-aqara ，按照网上的教程来，这个不难。然后本地开一个 MQTT Broker （如 mosquitto ），配置为本地监听，然后我编写了&lt;a href=&quot;https://github.com/jiegec/tools/blob/master/telegraf-mi-aqara.py&quot;&gt;脚本 telegraf-mi-aqara.py&lt;/a&gt; ，使用前需要 &lt;code class=&quot;highlighter-rouge&quot;&gt;pip install paho-mqtt&lt;/code&gt;，并且按照实际路径修改一下内容 。验证能够跑起来后，写一个 telegraf 配置：&lt;/p&gt;

&lt;div class=&quot;language-toml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nn&quot;&gt;[[inputs.exec]]&lt;/span&gt;
        &lt;span class=&quot;py&quot;&gt;commands&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/usr/bin/python3 /path/to/telegraf-mi-aqara.py&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;py&quot;&gt;timeout&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;5s&quot;&lt;/span&gt;
        &lt;span class=&quot;py&quot;&gt;data_format&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;influx&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;现在就可以读取到各项信息，如温度，湿度，是否开门，开关用电情况等等。&lt;/p&gt;

&lt;p&gt;2018-12-16 更新：&lt;/p&gt;

&lt;p&gt;研究了一下&lt;a href=&quot;https://github.com/aqara/aiot-gateway-local-api&quot;&gt;绿米网关局域网通信协议&lt;/a&gt;，得到了&lt;a href=&quot;https://github.com/jiegec/tools/blob/master/telegraf-mi-aqara-v2.py&quot;&gt;第二个版本 telegraf-mi-aqara-v2.py&lt;/a&gt;，它与第一版的区别是，第一版是主动向网关读取信息，而这一版则是监听组播包，等待网关发消息。这个脚本负责把读取到的组播信息发送到 MQTT ，再让 telegraf 从 MQTT 里解析 JSON 消息，写入数据库。Telegraf 配置如下：&lt;/p&gt;

&lt;div class=&quot;language-toml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nn&quot;&gt;[[inputs.mqtt_consumer]]&lt;/span&gt;
        &lt;span class=&quot;py&quot;&gt;servers&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;[&quot;tcp://127.0.0.1:1883&quot;]&lt;/span&gt;
        &lt;span class=&quot;py&quot;&gt;qos&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;py&quot;&gt;connection_timeout&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;30s&quot;&lt;/span&gt;
        &lt;span class=&quot;py&quot;&gt;topics&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;/telegraf-mi-aqara&quot;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;py&quot;&gt;persistent_session&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;
        &lt;span class=&quot;py&quot;&gt;client_id&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Telegraf&quot;&lt;/span&gt;
        &lt;span class=&quot;py&quot;&gt;data_format&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;json&quot;&lt;/span&gt;
        &lt;span class=&quot;py&quot;&gt;json_string_fields&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;model&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;sid&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;status&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;py&quot;&gt;tag_keys&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;model&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;sid&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;short_id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;由于设备不全，有些字段可能不完整。如果大家自己要用的话，可能需要自行修改一下。&lt;/p&gt;
</description>
        <pubDate>Thu, 13 Dec 2018 20:07:00 +0800</pubDate>
        <link>https://jiegec.me/software/2018/12/13/homebridge-mi-aqara-telegraf/</link>
        <guid isPermaLink="true">https://jiegec.me/software/2018/12/13/homebridge-mi-aqara-telegraf/</guid>
        
        <category>homebridge</category>
        
        <category>mi</category>
        
        <category>aqara</category>
        
        <category>telegraf</category>
        
        <category>influxdb</category>
        
        
        <category>software</category>
        
      </item>
    
      <item>
        <title>Grafana 可视化实践：清华大学 2018 年度人物评选</title>
        <description>&lt;p&gt;最近这段时间，清华内部正在投票选出今年的年度人物，想到最近刚好在学习使用 Grafana+InfluxDB+Telegraf 全家桶，于是想着能不能写个爬虫把数据都拿下来，然后用 Grafana 画出来，就可以得到一个投票随时间变化的趋势。爬虫很简单，就是登录，获取页面信息，然后按照 InfluxDB 的输入格式进行输出即可。代码放在了 &lt;a href=&quot;https://github.com/jiegec/student-tsinghua-vote18&quot;&gt;jiegec/student-tsinghua-vote18&lt;/a&gt; 下。&lt;/p&gt;

&lt;p&gt;接着就是用 Grafana 进行可视化，大概得到了这样一个曲线：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/vote18.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;为保护隐私，把名字隐去了。实际上的投票时间是从 12-3 号开始到 12-7号结束，但由于宿舍停电的原因所以采样的点在半夜的时候都没有，所以看起来有点奇怪，但还是能够反应总体的趋势的。比如可以看到前两名很早就一马当先，而后一直遥遥领先，下面的选手则排名变动很大，特别是截止前最后一段时间，大家都在拼命拉票，可见大家都是 DDL 选手啊。如果对上面这个图求个导，看看变化率的话：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/vote18-speed.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;这显现出了很有意思的一个趋势，就是每天十二点左右都有一个高峰期，然后在零点前大概熄灯附近的时间也是一个高峰期，另外就是截止前最后的抢票阶段，大家都在疯狂拉票，从中午拉到最后时刻。由于停电的原因，在零点附近的数据都比较的鬼畜，不过影响不大，趋势一目了然。&lt;/p&gt;

&lt;p&gt;Grafana 真香！期望可以学到更多高端的查询语法和可视化的骚操作，现在有很多东西不知道该怎么可视化，比较苦恼，不知道大家有没有什么经验可以分享。&lt;/p&gt;
</description>
        <pubDate>Fri, 07 Dec 2018 23:03:00 +0800</pubDate>
        <link>https://jiegec.me/software/2018/12/07/grafana-visualize-vote18/</link>
        <guid isPermaLink="true">https://jiegec.me/software/2018/12/07/grafana-visualize-vote18/</guid>
        
        <category>grafana</category>
        
        <category>influxdb</category>
        
        <category>telegraf</category>
        
        <category>nodejs</category>
        
        <category>scraper</category>
        
        
        <category>software</category>
        
      </item>
    
      <item>
        <title>每周分享第 1 期</title>
        <description>&lt;p&gt;向阮一峰学习，把自己在一周里看到的有趣的事情分享一下。不过形式就比较随意了。&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;最近写 MongoDB + NodeJS 学到的新操作：$addToSet $nin $ne Mongoose 的 setDefaultsOnInsert&lt;/li&gt;
  &lt;li&gt;Promise 真香，真好用&lt;/li&gt;
  &lt;li&gt;几天前惠老师还在说 “IE, The best Chrome Downloader Downloader, ever” 今天 EdgeHTML 就宣告死亡了&lt;/li&gt;
  &lt;li&gt;WPF, Windows Forms 和 WinUI 开源了，mono 这是要凉？ &lt;a href=&quot;https://blogs.windows.com/buildingapps/2018/12/04/announcing-open-source-of-wpf-windows-forms-and-winui-at-microsoft-connect-2018/&quot;&gt;链接&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;有人逆向了 FGPA 的 bitstream 格式，希望 FPGA 有朝一日可以进入 开源时代？ &lt;a href=&quot;https://github.com/mmicko/prjtang&quot;&gt;链接&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;造机的 baseline 就决定是 &lt;a href=&quot;https://github.com/Icenowy/ice-risc&quot;&gt;它&lt;/a&gt; 了&lt;/li&gt;
  &lt;li&gt;根据 AST 炼丹判相似度还行，好奇它跨语言的预测水准 &lt;a href=&quot;https://code2vec.org/&quot;&gt;链接&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;可视化 h264 nalu 的软件 &lt;a href=&quot;https://github.com/shi-yan/H264Naked&quot;&gt;H264Naked&lt;/a&gt; （做的好糙啊，想交 pr）&lt;/li&gt;
  &lt;li&gt;ffprobe -show_packets 和 ffprobe -show_frame 真好用&lt;/li&gt;
  &lt;li&gt;发现一个解决 ArchLinux 滚内核后无法 modprobe 的&lt;a href=&quot;https://github.com/saber-nyan/kernel-modules-hook&quot;&gt;方案&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;010 Editor 和 Hex Fiend 是二进制分析的神器啊… Kaitai 还有待加油&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/roman01la/cljss&quot;&gt;CSS-in-JS for ClojureScript&lt;/a&gt; 真香 有空可以试试用 ClojureScript 写前端&lt;/li&gt;
  &lt;li&gt;Safari Technology Preview 71 加入了 Web Authentication 这是要支持 U2F 的节奏？&lt;/li&gt;
  &lt;li&gt;Grafana+InfluxDB+Telegraf 真科学，随手写了一些简单的 Telegraf 的 input plugin&lt;/li&gt;
  &lt;li&gt;给 010 Editor 写了俩 .bt 文件，见我上一篇博客&lt;/li&gt;
  &lt;li&gt;海思 cc 居然支持 ASan : /opt/hisi-linux/x86-arm/arm-hisiv600-linux/arm-hisiv600-linux-gnueabi/lib/a7/libasan.so&lt;/li&gt;
  &lt;li&gt;遇到了 &lt;a href=&quot;https://github.com/influxdata/telegraf/issues/4881&quot;&gt;设备名有空格导致 telegraf 读取 S.M.A.R.T. 信息失败&lt;/a&gt; 的锅，不过似乎没人修&lt;/li&gt;
  &lt;li&gt;看到了一个很有意思的 Interview Pass Rate 关于使用的编辑器的调查，很有意思 &lt;a href=&quot;https://triplebyte.com/blog/editor-report-the-rise-of-visual-studio-code&quot;&gt;链接&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;发现一个 JSX 的替代品，用了 Template literal syntax ，挺好的 &lt;a href=&quot;https://github.com/developit/htm&quot;&gt;链接&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;也不知道能不能坚持下来，就这样了，发布（逃&lt;/p&gt;
</description>
        <pubDate>Fri, 07 Dec 2018 15:57:00 +0800</pubDate>
        <link>https://jiegec.me/misc/2018/12/07/weekly-sharing/</link>
        <guid isPermaLink="true">https://jiegec.me/misc/2018/12/07/weekly-sharing/</guid>
        
        <category>weeklysharing</category>
        
        
        <category>misc</category>
        
      </item>
    
      <item>
        <title>编写 010 Editor 的 FLV Template</title>
        <description>&lt;p&gt;最近在做 FLV 和 H264 方面的研究，研究了很多标准和文档，然后用 010 Editor 对着文件进行分析。这个软件真的很好用，对研究二进制结构用处特别大。不过它自带的 FLV.bt 功能不是很好，我对它加上了 H264(AVC) 的部分支持，放在了 &lt;a href=&quot;https://github.com/jiegec/tools/blob/master/myFLV.bt&quot;&gt;myFLV.bt&lt;/a&gt; 里。我也写了 H264 的解析，不过效率不高，大文件要卡好一会。&lt;/p&gt;

&lt;p&gt;除此之外，很多格式，010 editor 都有支持，特别好用，它的解析器语法也很好写。&lt;/p&gt;
</description>
        <pubDate>Thu, 06 Dec 2018 20:33:00 +0800</pubDate>
        <link>https://jiegec.me/software/2018/12/06/010-editor-flv-parsing/</link>
        <guid isPermaLink="true">https://jiegec.me/software/2018/12/06/010-editor-flv-parsing/</guid>
        
        <category>010editor</category>
        
        <category>macos</category>
        
        <category>parser</category>
        
        <category>binary</category>
        
        <category>hex</category>
        
        <category>flv</category>
        
        <category>h264</category>
        
        <category>avc</category>
        
        
        <category>software</category>
        
      </item>
    
      <item>
        <title>配置 Grafana+InfluxDB+Telegraf 并添加 MIIO 数据来源</title>
        <description>&lt;p&gt;之前一直想配一个监控系统，现在有机会了，就简单配了一下。发现真的特别简单，用 Homebrew 安装这三个软件并且都跑起来，然后稍微动一下配置，就可以得到可观的效果了。&lt;/p&gt;

&lt;p&gt;然后想利用 miio 配置一下，把宿舍的空气净化器各项参数拿到，以 Telegraf 的插件形式定时上报，然后通过 Grafana 进行可视化。插件放在了 &lt;a href=&quot;https://github.com/jiegec/tools/blob/master/telegraf/miio.py&quot;&gt;jiegec/tools&lt;/a&gt; 下，就是一个简单的 Python 脚本。配置方法如下：&lt;/p&gt;

&lt;p&gt;编辑 &lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/local/etc/telegraf.d/miio.conf&lt;/code&gt;：&lt;/p&gt;

&lt;div class=&quot;language-ini highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nn&quot;&gt;[[inputs.exec]&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;]&lt;/span&gt;
	&lt;span class=&quot;py&quot;&gt;commands&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;[&quot;/usr/local/bin/python3 /Volumes/Data/tools/telegraf/miio.py MIID_HERE&quot;]&lt;/span&gt;
	&lt;span class=&quot;py&quot;&gt;timeout&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;5s&quot;&lt;/span&gt;
	&lt;span class=&quot;py&quot;&gt;data_format&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;influx&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;默认了 miio 路径为 &lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/local/bin/miio&lt;/code&gt; 。&lt;/p&gt;
</description>
        <pubDate>Tue, 27 Nov 2018 20:33:00 +0800</pubDate>
        <link>https://jiegec.me/software/2018/11/27/grafana-influxdb-telegraf-miio/</link>
        <guid isPermaLink="true">https://jiegec.me/software/2018/11/27/grafana-influxdb-telegraf-miio/</guid>
        
        <category>macos</category>
        
        <category>grafana</category>
        
        <category>influxdb</category>
        
        <category>telegraf</category>
        
        <category>miio</category>
        
        
        <category>software</category>
        
      </item>
    
      <item>
        <title>强制启用 Google Chrome 原生的 Dark Mode</title>
        <description>&lt;p&gt;Mojave 的 Dark Mode 真香，但是 Google Chrome 并不会随着系统的 Dark Mode 设置变化，所以 NightOwl 只能让部分软件按照时间变更 Dark/Light Mode 。一番搜索，发现其实 Google Chrome 其实已经&lt;a href=&quot;https://chromium-review.googlesource.com/c/chromium/src/+/1238796&quot;&gt;支持了 Dark Mode&lt;/a&gt;，但只能设置，不能按照系统的状态自动切换，命令如下：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ open -a Google\ Chrome --args --force-dark-mode
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;然后就可以看到 Google Chrome 已经是 Dark Mode 了。但可惜并不能自动切换。&lt;/p&gt;

</description>
        <pubDate>Tue, 27 Nov 2018 00:17:00 +0800</pubDate>
        <link>https://jiegec.me/software/2018/11/27/enable-dark-mode-google-chrome/</link>
        <guid isPermaLink="true">https://jiegec.me/software/2018/11/27/enable-dark-mode-google-chrome/</guid>
        
        <category>macos</category>
        
        <category>darkmode</category>
        
        <category>googlechrome</category>
        
        
        <category>software</category>
        
      </item>
    
      <item>
        <title>Mac 上安装 Arch Linux ， ZFS 真香</title>
        <description>&lt;p&gt;最近在 Mac 上装了 Arch Linux ，按照 &lt;a href=&quot;https://wiki.archlinux.org/index.php/Mac&quot;&gt;Mac - Arch Linux Wiki&lt;/a&gt; 一路一路走，创建单独的一个 EFI 分区给 Arch Linux 放 GRUB 和内核，一个 ext4 作为根分区。由于 Arch ISO 不支持 Broadcom 的无线网卡，于是先拿 Apple Ethernet Adapter 连到路由器上装机。然后把一些需要的驱动装上了，桌面用的 KDE Plasma ，Trackpad 用的 xf86-input-mtrack-git ， HiDPI 设置为 2x Scale ，各种体验都还可以，就是 Wi-Fi 的 802.1X 没配置好，然后 kwalletd5 老是崩没找到原因。常见的应用除了微信基本都有，也终于可以体验 Steam Play ，利用 Proton 在 Linux 上跑一些只支持 Windows 的游戏，不过我已经很少玩游戏了。&lt;/p&gt;

&lt;p&gt;然后我就想，怎么做 macOS 和 Linux 之间的文件共享。典型的操作可能是 exFAT ，但是作为数据盘的话，这还是不大适合。或者就直接用 ext4 ，配合 extFS For Mac by Paragon 使用，也可以，最后我选择了 ZFS 。&lt;/p&gt;

&lt;p&gt;在 macOS 上安装 &lt;a href=&quot;https://openzfsonosx.org/&quot;&gt;OpenZFS on OSX&lt;/a&gt; ，在 Linux 上安装 &lt;a href=&quot;https://zfsonlinux.org/&quot;&gt;ZFS on Linux&lt;/a&gt; 。具体命令就是：&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;brew cask install openzfs &lt;span class=&quot;c&quot;&gt;# macOS&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yay zfs-dkms-git &lt;span class=&quot;c&quot;&gt;# Arch Linux&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;由于硬盘空间所限，我只用了一个分区作为 vdev ，没有采用 mirror 、 raidz 等方案。我首先在 macOS 上创建了一个 zpool ，参考 &lt;a href=&quot;https://openzfsonosx.org/wiki/Zpool#Creating_a_pool&quot;&gt;Creating a pool - OpenZFS on OSX&lt;/a&gt; ：&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;zpool create &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ashift&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;13 Data diskxsy
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;此时应该能够看到 /Volumes/Data 上已经挂载了一个 ZFS Dataset 。我采用 &lt;a href=&quot;https://github.com/cbreak-black/ZetaWatch&quot;&gt;cbreak-black/ZetaWatch&lt;/a&gt; 在菜单栏里查看 ZFS 信息。此时回到 Arch Linux 上，通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;zfs import&lt;/code&gt; 可以找到并且挂载这个 ZFS Dataset 到 &lt;code class=&quot;highlighter-rouge&quot;&gt;/Data&lt;/code&gt; 处。&lt;/p&gt;

&lt;p&gt;我还尝试创建了一个加密的 ZFS Dataset ，对加密的部分的粒度控制可以很细。另外，我参考 &lt;a href=&quot;https://openzfsonosx.org/wiki/Time_Machine_Backups&quot;&gt;Time Machine Backups - OpenZFS on OSX&lt;/a&gt; 也在移动硬盘上划出一个新的分区作为 ZFS ，在上面创建了一个加密的 Sparse Bundle ，把它作为 Time Machine 的目标。之后还会尝试一下 &lt;code class=&quot;highlighter-rouge&quot;&gt;zfs send&lt;/code&gt; 作为替代的备份方案。&lt;/p&gt;
</description>
        <pubDate>Mon, 26 Nov 2018 20:51:00 +0800</pubDate>
        <link>https://jiegec.me/software/2018/11/26/zfs-on-macos-and-linux/</link>
        <guid isPermaLink="true">https://jiegec.me/software/2018/11/26/zfs-on-macos-and-linux/</guid>
        
        <category>linux</category>
        
        <category>zfs</category>
        
        <category>macos</category>
        
        <category>timemachine</category>
        
        <category>backup</category>
        
        
        <category>software</category>
        
      </item>
    
      <item>
        <title>USB/IP 实践</title>
        <description>&lt;p&gt;之前一直想玩 USB/IP ，但是一直没有找俩 Linux 设备然后共享，今天终于尝试了一下，没有什么大问题。这次采用的设备是 Raspberri Pi 3 和 SaltedFish Pi 。一开始尝试从后者向前者共享，但总是出现这个错误：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;libusbip: error: udev_device_get_sysattr_value failed
usbip: error: open vhci_driver
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;然后我反过来做就好了，比较神奇。&lt;/p&gt;

&lt;p&gt;主要过程如下：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;pacman -S usbip&lt;/code&gt; 安装用户态软件&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;systemctl enable --now usbipd&lt;/code&gt; 启动 USB/IP 的端口监听 daemon&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;usbip list -l&lt;/code&gt; 查看本地有哪些 USB 设备可以共享&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;usbip bind -b [BUS_ID]&lt;/code&gt; 把指定的 USB 设备共享出去，其中 BUS_ID 从上个命令中查看&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;usbip list -r [IP]&lt;/code&gt; 在另一个设备上查看这个设备共享的 USB 设备，可以看到许多信息&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;usbip attach -r [IP] -b [BUS_ID]&lt;/code&gt; 把对方共享的 USB 设备 attach 到本地&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;效果：把一个 U 盘成功映射到了本地：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ lsusb -t
/:  Bus 04.Port 1: Dev 1, Class=root_hub, Driver=vhci_hcd/8p, 480M
    |__ Port 1: Dev 2, If 0, Class=Mass Storage, Driver=usb-storage, 480M
$ lsblk
NAME        MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
sda           8:0    1 14.9G  0 disk
`-sda1        8:1    1 14.9G  0 part /tmp/mnt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;尝试 mount 什么的，也都没有问题。以后可以考虑把本地的 LicheeTang 通过这种方式穿透到远端，然后在远端用它的 IDE 进行编程。&lt;/p&gt;

&lt;p&gt;UPDATE: LicheeTang 烧写有一些问题，直接 JTAG 写上去没有作用，但是 SPI Flash 是可以成功写入并且有作用的，虽然需要强制打断。感觉还是网络延迟导致了一些问题。&lt;/p&gt;
</description>
        <pubDate>Tue, 20 Nov 2018 18:50:00 +0800</pubDate>
        <link>https://jiegec.me/software/2018/11/20/usb-ip/</link>
        <guid isPermaLink="true">https://jiegec.me/software/2018/11/20/usb-ip/</guid>
        
        <category>linux</category>
        
        <category>usbip</category>
        
        <category>raspi</category>
        
        <category>sfpi</category>
        
        
        <category>software</category>
        
      </item>
    
  </channel>
</rss>
